*perfitys.txt*          For Vim version 7.4
                                                                *perfitys*
                              Perfitys plugin

The author has started writing the Perfitys Vim plugin to fulfill his personal
needs as a Vim user without cluttering his |vimrc| file with autocommands and
other settings. The plugin applies per file type settings and offers some
basic IDE (Integrated Development environment) features and automatic typing
fonctionalities.

The default behaviour of the plugin may not be suitable to every Vim users but
the plugin is extremely customizable and every default setting can be
overwritten by assigning specific variables in the |vimrc| file.

This plugin is a work in (slow) progress and new features may be added and
existing default settings modified.

The file type support is far from complete. Only a few file types are
supported. But support for other file types can easily be added.

1. Installation                 |perfitys-install|
2. Supported file types         |perfitys-supported-file-types|
3. Disabling the plugin         |perfitys-disabling|
4. Per file type settings       |perfitys-per-file-type-settings|
        4.1. Text width                         |perfitys-textwidth|
        4.2. Tab preferences                    |perfitys-tab|
        4.3. Alternative file type              |perfitys-alt-filetype|
        4.4. "End of line" comment              |perfitys-eol-comment|
        4.5. Bullet-lists                       |perfitys-bullet-lists|
        4.6. Folding method                     |perfitys-fold-method|
5. IDE features                 |perfitys-ide|
        5.1. Population of the quickfix window  |perfitys-populate-quickfix|
        5.2. Running the current file           |perfitys-run-current-file|
6. Automatic typing             |perfitys-automatic-typing|
        6.1. Primary separator                  |perfitys-primary-separator|
        6.2. Secondary separator                |perfitys-secondary-separator|
7. Credits and licensing        |perfitys-credits|

==============================================================================
1. Installation                                         *perfitys-install*

The Perfitys plugin comes with the following directory tree:

perfitys
        autoload
        doc
        ftplugin
        plugin

If you use Pathogen (a popular Vim plugin to manage Vim plugins), you just
have to place the whole tree in your bundle directory (on a Linux system, it
is probably ~/.vim/bundle). If you have Git installed and an internet access,
just issue this command in a terminal after moving to your bundle directory:

git clone git://github.com/thierr26/perfitys.git

Make sure that Pathogen and the filetype plugins are enabled in your |vimrc|
file with the following commands: >

        call pathogen#infect()
        call pathogen#helptags()
        filetype plugin indent on
<

The author hasn't tested the other popular Vim plugin managers, but it should
be possible to do the installation in a similar way when using those plugins.

If you don't use a plugin manager, you have to manually copy the files. For
example, on a Linux system, the files in perfitys/autoload must be copied to
~/.vim/autoload. The files in perfitys/doc must be copied to ~/.vim/doc,
etc...

Whatever the way you have installed Perfitys, you have to make sure you have
enabled the filetype plugins in your |vimrc| file with the
"filetype plugin indent on" command. See |filetype-plugins|.

==============================================================================
2. Supported file types                 *perfitys-supported-file-types*

Currently, the following file types are supported:

ada
c
conf
css
gitcommit
haskell
help
html
matlab
php
sh
text
vim
xdefaults

==============================================================================
3. Disabling the plugin                                 *perfitys-disabling*

                                        *loaded_perfitys* *g:loaded_perfitys*
You can completely disable the Perfitys plugin without uninstalling it by
adding this line to your |vimrc| file: >

        let g:loaded_perfitys = 1
<

                                        *perfitys_do_not_set_did_ftplugin*
                                        *g:perfitys_do_not_set_did_ftplugin*
The file type specific scripts of Perfitys are not run if another filetype
plugin has already set the variable b:did_ftplugin.

If they are run, the Perfitys file type specific scripts set the variable
b:did_ftplugin, which causes other filetype plugins to be disabled. You can
prevent Perfitys from setting b:did_ftplugin by adding the following line to
your |vimrc| file: >

        let g:perfitys_do_not_set_did_ftplugin = 1
<

If you want to prevent Perfitys from setting b:did_ftplugin for a specific
file type only (say the "sh" file type), add the following line to your
|vimrc| file: >

        let g:perfitys_ada_do_not_set_did_ftplugin = 1
<

==============================================================================
4. Per file type settings               *perfitys-per-file-type-settings*

4.1. Text width                                 *perfitys-textwidth*

                                        *perfitys-per-file-type-textwidth*
The 'textwidth' option is set by Perfitys depending on the file type. The
default settings are as follows:

| File type                        | 'textwidth' option value |
|--------------------------------- + -------------------------|
| ada, c, conf, css, haskell, html | 79                       |
| gitcommit                        | 72                       |
| help, text                       | 78                       |
| php, sh, vim, xdefaults, matlab  | 79                       |

The default settings can be overwritten by setting global variables in your
|vimrc| file. For example, if you want a text width of 80 for the sh file
type, add the following line to your |vimrc| file: >

        let g:perfitys_sh_textwidth = 80
<

                                        *perfitys_common_textwidth*
                                        *g:perfitys_common_textwidth*
If you don't want a per file type text width, but a common text width (say 80)
for all the supported file types, add the following line to your |vimrc| file:
>
        let g:perfitys_common_textwidth = 80
<

                                *perfitys_colorcolumn_relative_to_width*
                                *g:perfitys_color_column_relative_to_width*
Perfitys also changes the 'colorcolumn' option. By default, it adds a value
which is the textwidth value plus two. If you prefer to highlight the
column next to text width, add the following line to your |vimrc| file: >

        let g:perfitys_colorcolumn_relative_to_width = 1
<

Note that if the text width has been set to 0, then the 'colorcolumn' option
is not affected.

                                        *perfitys_do_not_set_colorcolumn*
                                        *g:perfitys_do_not_set_colorcolumn*
If you don't want Perfitys to affect the 'colorcolumn' option at all, add the
following line to your |vimrc| file: >

        let g:perfitys_do_not_set_colorcolumn = 1
<

----------------------------------------------
4.2. Tab preferences                                    *perfitys-tab*

                                                *perfitys-per-file-tabstop*
The 'tabstop', 'shiftwidth' and 'softtabstop' are set by Perfitys depending on
the file type. The default settings are as follows:

| File type     | 'tabstop', 'shiftwidth' and 'softtabstop' options value |
|-------------- + --------------------------------------------------------|
| ada           | 3                                                       |
| c, conf, css  | 4                                                       |
| gitcommit     | 4                                                       |
| haskell, html | 4                                                       |
| matlab        | 4                                                       |
| php, sh, vim  | 4                                                       |
| help, text    | 8                                                       |
| xdefaults     | 4                                                       |

The default settings can be overwritten by setting global variables in your
|vimrc| file. For example, if you want a tab width of 8 for the sh file type,
add the following line to your |vimrc| file: >

        let g:perfitys_sh_tabstop = 8
<

                                        *perfitys_common_tabstop*
                                        *g:perfitys_common_tabstop*
If you don't want a per file type tab width, but a common tab width (say 8)
for all the supported file types, add the following line to your |vimrc| file:
>
        let g:perfitys_common_tabstop = 8
<

                                                *perfitys-per-file-expandtab*
By default, the 'expandtab' option is set to expandtab for all the supported
file types. If for a particular file type (say sh) you want the 'expandtab'
option set to noexpandtab, add the following line to your |vimrc| file: >

        let g:perfitys_sh_expandtab = "noexpandtab"
<

Actually, the allowed values for such variables are "expandtab",
"noexpandtab", "et" and "noet", similarly to the 'expandtab' option.

                                        *perfitys_common_expandtab*
                                        *g:perfitys_common_expandtab*
If you want the 'expandtab' option to be set to noexpandtab for all the
supported file types, add the following line to your |vimrc| file: >

        let g:perfitys_common_expandtab = "noexpandtab"
<

----------------------------------------------
4.3. Alternative file type                      *perfitys-alt-filetype*

                                                                *:AltFileType*
Perfitys provides a function to change the 'filetype' option for a buffer
(only if the 'filetype' option has been set). This function can be operated
using the :AltFileType command, or using the Plugin | Perfitys menu.

A key mapping is also defined: <Leader>FT

You can change this mapping (say to <Leader>ZZ) by adding the following line
to your |vimrc| file: >

        map <Leader>ZZ <Plug>PerfitysAltFileType
<

With the default setting, the functions changes the 'filetype' option if the
'filetype' option is set to "help", "text", "php" or "html". If the 'filetype'
option has an other value, the function does not change it.

| When 'filetype' is set to | :AltFileType changes it to |
|-------------------------- + ---------------------------|
| help                      | text                       |
| text                      | help                       |
| html                      | php                        |
| php                       | html                       |

                                                *g:perfitys_alt_filetype*
You can redefine the behaviour of the function by adding a line like the
following in your |vimrc| file: >

let g:perfitys_alt_filetype = {'help': "text", 'php': "html"}
<

g:perfitys_alt_filetype is a dictionary variable defining pairs of filetype
values. If the 'filetype' option is in one of the pairs, then the function
changes the 'filetype' value to the other value of the pair. You can add all
the pairs you need.

----------------------------------------------
4.4. "End of line" comment                      *perfitys-eol-comment*

The Vim default value for the 'comments' option seems to be:

s1:/*,mb:*,ex:*/,://,b:#,:%,:XCOMM,n:>,fb:-

For the file types which support "end of line" comments, Perfitys adds the
associated comment leader to the 'comments' option (unless the comment leader
is already in the 'comments' option.

For exemple, for the ada file type, Perfitys changes the 'comments' option to:

s1:/*,mb:*,ex:*/,://,b:#,:%,:XCOMM,n:>,fb:-,b:--

(",b:--" has been appended to the 'comments' option).

----------------------------------------------
4.5. Bullet-lists                               *perfitys-bullet-lists*

The Vim default value for the 'comments' option seems to be:

s1:/*,mb:*,ex:*/,://,b:#,:%,:XCOMM,n:>,fb:-

The "fb:-" means that "- " is considered to be a leader for a bullet-list
item (see |format-comments|). And this is applied for all file types.

The only action of Perfitys regarding bullet-lists is to set the 'comments'
option to "://,b:#,:%,:XCOMM,n:>,fb:-,fb:*" for the gitcommit file type. This
implies that for the gitcommit file type, both "- " and "* " are considered to
be leaders for bullet-list items.

----------------------------------------------
4.6. Folding method                             *perfitys-fold-method*
                                                *perfitys-foldmethod*

The 'foldmethod' option is set or not set by Perfitys, depending on the file
type. The default settings are as follows:

| File type        | 'foldmethod' option value             |
|----------------- + --------------------------------------|
| sh, vim          | expr                                  |
| other file types | 'foldmethod' not affected by Perfitys |

The default settings can be overwritten by setting global variables in your
|vimrc| file. For example, if you want 'foldmethod' set to indent for the sh
file type, add the following line to your |vimrc| file: >

        let g:perfitys_sh_foldmethod = "indent"
<

For a file type for which Perfitys sets the 'foldmethod' option, if the value
of the 'foldmethod' option is "expr", Perfitys sets the 'foldexpr' option to
"PerfitysShFoldLevel(v:lnum)" if the function PerfitysShFoldLevel exists, or
to "0" if the function does not exist. The "Sh" part in the name of the
function refers to the file type. For a file type other than sh, say html, the
name of the function would be PerfitysHtmlFoldLevel.

You can specify another expression for the 'foldexpr' option by assigning it
to a global variable in your |vimrc| file. For example, for the file type sh,
the name of the variable would be g:perfitys_sh_foldexpr.

You can see the behavior of Perfitys by downloading and opening the following
files:

pull_vim_plugins from this repository:
https://github.com/thierr26/thierr26_vim-gtk_config/blob/master/

plugin/perfitys.vim from this repository:
https://github.com/thierr26/perfitys

                                                *perfitys-foldtext*
As far as the 'foldtext' option is concerned, you can specify your own
expression by assigning it to a global variable in your |vimrc| file. For
example, for the file type sh, the name of the variable would be
g:perfitys_sh_foldtext.

                                        *perfitys_do_not_set_foldmethod*
                                        *g:perfitys_do_not_set_foldmethod*
If you don't want Perfitys to affect the 'foldmethod' option at all, add the
following line to your |vimrc| file: >

        let g:perfitys_do_not_set_foldmethod = 1
<

==============================================================================
5. IDE features                                 *perfitys-ide*

5.1. Population of the quickfix window          *perfitys-populate-quickfix*

                                                        *:VimgrepInQF*
Perfitys provides a function to populate the |quickfix-window|. This function
can be operated using the :VimgrepInQF command, or using the Plugin | Perfitys
menu. It runs a |vimgrep| command and opens the |quickfix-window| if the
|vimgrep| command has yielded results.

A key mapping is also defined: <Leader>QF

You can change this mapping (say to <Leader>ZZ) by adding the following line
to your |vimrc| file: >

        map <Leader>ZZ <Plug>PerfitysVimgrepInQF
<

The function is applicable if a buffer local variable exists with the name
b:perfitys_vimgrepinqf_params and this variable is a dictionary with the
following keys:
- reg_exp: The regular expression to be used in the |vimgrep| command;
- file: a string to be used as the file argument in the |vimgrep| command;
- min_cwd_depth: a directory depth threshold (if the depth of the current
  directory is below this threshold, then the function will abort);
- relative_to_home: if nonzero, then the directory depth will be evaluated
  relative to the user's home directory and the function will abort if the
  current directory is not below the user's home directory.

By default, Perfitys defines such a dictionary for a few file types:

| File type | reg_exp                       | file     |
|---------- + ----------------------------- + ---------|
| vim       | ^\s*fu\(nction\)\?!\?\s*\S\+( | **/*.vim |

min_cwd_depth is set to 2 and relative_to_home to 1.

                                                        *:MakeQFTaller*
                                                        *:MakeQFSmaller*
Some functions are provided to change the height of the quickfix window. They
can be operated using the :MakeQFTaller and :MakeQFSmaller commands or using
the Plugin | Perfitys menu.

Key mappings are also defined: <Leader>+ and <Leader>-

To change the mappings add lines like the following in your |vimrc| file: >

        map <Leader>ZZ <Plug>PerfitysMakeQFTaller
<

                                                *perfitys_qfheightstep*
                                                *g:perfitys_qfheightstep*
By default, the height of the quickfix window changes by steps of three lines.
You can force the step to a different value (say 6) by adding the following
line in your |vimrc| file: >
        let g:perfitys_qfheightstep = 6

<

----------------------------------------------
5.2 Running the current file                    *perfitys-run-current-file*

                                                        *:RunWithArgs*
Perfitys provides a function to run the currently edited file with user
defined arguments. This function can be operated using the :RunWithArgs
command, or using the Plugin | Perfitys menu.

A key mapping is also defined: F8

You can change this mapping (say to <Leader>ZZ) by adding the following line
to your |vimrc| file: >

        map <Leader>ZZ <Plug>PerfitysRunWithArgs
<

The function lets the user type the arguments (separated by spaces) to be used
and then runs the currently edited files with those arguments.

                                                        *:RunAgainWithArgs*
Another function is provided to run the currently edited file again with the
same arguments. This function can be operated using the :RunAgainWithArgs
command, or using the Plugin | Perfitys menu.

A key mapping is also defined: F9

You can change this mapping (say to <Leader>ZZ) by adding the following line
to your |vimrc| file: >

        map <Leader>ZZ <Plug>PerfitysRunAgainWithArgs
<

                                        *:RedirectOutputToNewBuffer*
                                        *:DoNotRedirectOutputToNewBuffer*
By default, the output is displayed in the status line. You can change this
behavior using the :RedirectOutputToNewBuffer command. It causes the output to
be redirected to new buffer.

The command is available in the Plugin | Perfitys menu and a key mapping is
defined: <Leader>RR

You can change this mapping (say to <Leader>ZZ) by adding the following line
to your |vimrc| file: >

        map <Leader>ZZ <Plug>PerfitysRedirectOutputToNewBuffer
<

You can revert to the default behavior using the
:DoNotRedirectOutputToNewBuffer. The key mapping is: <Leader>RN

You can change this mapping (say to <Leader>ZZ) by adding the following line
to your |vimrc| file: >

        map <Leader>ZZ <Plug>PerfitysDoNotRedirectOutputToNewBuffer
<

Running the current file is currently applicable to the files of type:
sh

==============================================================================
6. Automatic typing                             *perfitys-automatic-typing*

                                                *perfitys-separator*
6.1. Primary separator                          *perfitys-primary-separator*

Perfitys provides a function for inserting a separator line in the current
buffer. Well actually two functions, because the author has encountered the
need for two different kinds of separator lines in the same file.

Both kinds of separator lines are comment lines if the file type is of a
programming language supported by Perfitys.

One kind is said "primary separator", the other kind is said "secondary
separator".

                                                                *:Sep*
                                                                *:PrimSep*
A primary separator line can be inserted using the :Sep or :PrimSep commands,
or using the Plugin | Perfitys menu.

A key mapping is also defined: <Leader>SS

You can change this mapping (say to <Leader>ZZ) by adding the following line
to your |vimrc| file: >

        map <Leader>ZZ <Plug>PerfitysPrimSep
<

The exact look of a separator line depends on the file type, but you can force
you look you want by assigning specific dictionary variables in your |vimrc|
file.

For example, the following statement in your |vimrc| file will cause the
primary separator lines to contain "+-" sequences and to be 79 characters long
and to be surrounded by one empty line when the file type is "sh": >

        let g:perfitys_sh_prim_sep = {
                    \ 'indent_level': 0,
                    \ 'post_comment_leader_space': " ",
                    \ 'repeating_sequence': "+-",
                    \ 'length': 79,
                    \ 'pre_comment_trailer_space': " ",
                    \ 'empty_lines_above': 1,
                    \ 'empty_lines_below': 1,
                    \ }
<

                                                *perfitys_common_prim_sep*
                                                *g:perfitys_common_prim_sep*
You can force the same look for primary separators in all the file types by
assigning a similar dictionary to g:perfitys_common_prim_sep in your |vimrc|
file: >

        let g:perfitys_common_prim_sep = {
                    \ 'indent_level': 0,
                    \ 'post_comment_leader_space': " ",
                    \ 'repeating_sequence': "+-",
                    \ 'length': 79,
                    \ 'pre_comment_trailer_space': " ",
                    \ 'empty_lines_above': 1,
                    \ 'empty_lines_below': 1,
                    \ }
<

----------------------------------------------
6.2. Secondary separator                        *perfitys-secondary-separator*

Secondary separator lines are similar to primary separator lines (see
|perfitys-primary-separator|), but they can have there own look.
                                                                *:SecondSep*
A secondary separator line can be inserted using the :SecondSep command, or
using the Plugin | Perfitys menu.

The key mapping is: <Leader>S

You can change this mapping (say to <Leader>ZZ) by adding the following line
to your |vimrc| file: >

        map <Leader>ZZ <Plug>PerfitysSecondSep
<

                                                *perfitys_common_second_sep*
                                                *g:perfitys_common_second_sep*
You can force the look for secondary separators the same way you can for a
primary separator, by assigning specific dictionary variables in your |vimrc|
file: >

        let g:perfitys_sh_second_sep = {
                    \ 'indent_level': 2,
                    \ 'post_comment_leader_space': " ",
                    \ 'repeating_sequence': "+-",
                    \ 'length': 59,
                    \ 'pre_comment_trailer_space': " ",
                    \ 'empty_lines_above': 1,
                    \ 'empty_lines_below': 1,
                    \ }
<

to apply the look to files of type "sh" only, or >

        let g:perfitys_common_prim_sep = {
                    \ 'indent_level': 2,
                    \ 'post_comment_leader_space': " ",
                    \ 'repeating_sequence': "+-",
                    \ 'length': 59,
                    \ 'pre_comment_trailer_space': " ",
                    \ 'empty_lines_above': 1,
                    \ 'empty_lines_below': 1,
                    \ }
<

to apply the look to all file types.

==============================================================================
7. Credits and licensing                        *perfitys-credits*

Author: Thierry Rascle (thierr26@free.fr)

Licensed under the Unlicense license (see http://unlicense.org).
